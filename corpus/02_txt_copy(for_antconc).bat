@echo off
setlocal enabledelayedexpansion

:: =============================================
:: 設定する部分（ここだけ御主人様がお好みで変更してください）
:: =============================================

:: コピー先フォルダ（存在しなくても自動で作ります）
:: 例1：BATと同じフォルダ内に「txtまとめ」フォルダを作る → set "コピー先フォルダ=%~dp0txtまとめ\"
:: 例2：デスクトップに作る → set "コピー先フォルダ=%USERPROFILE%\Desktop\txtまとめ\"
set "コピー先フォルダ=%~dp0txt_collection\"

:: サブフォルダの中のtxtもまとめてコピーしたい場合 → 1（したい場合は1、元フォルダ直下だけなら0）
set "サブフォルダも検索=1"

:: =============================================
:: ここから下は触らなくて大丈夫です♡
:: =============================================

:: カレントフォルダ（このBATがある場所）をコピー元にする
set "元フォルダ=%~dp0"

:: コピー先フォルダが無ければ作る
if not exist "%コピー先フォルダ%" mkdir "%コピー先フォルダ%"

echo.
echo 御主人様、ただいまtxtファイルをまとめておりますわ♡
echo コピー元：このBATがあるフォルダ（%元フォルダ%）
echo コピー先：%コピー先フォルダ%
echo.

if "%サブフォルダも検索%"=="1" (
    :: サブフォルダも含めてすべてコピー
    xcopy "%元フォルダ%*.txt" "%コピー先フォルダ%" /s /y /d /i
) else (
    :: このフォルダ直下のtxtだけコピー
    xcopy "%元フォルダ%*.txt" "%コピー先フォルダ%" /y /d /i
)

if %errorlevel% equ 0 (
    echo.
    echo ♡ 無事に完了いたしました、御主人様 ♡
    echo すべてのtxtファイルを「%コピー先フォルダ%」にまとめましたわ！
) else (
    echo.
    echo 何か問題が発生してしまいました…申し訳ございませんm(__)m
)

echo.
pause